{
  "version": 3,
  "sources": ["../lib/draggable-mixin.ts"],
  "sourcesContent": ["import { type LitElement, css } from 'lit';\ntype Constructor<T = object> = new (...args: any[]) => T;\ndeclare class DraggableMixinInterface {\n  dragable: boolean;\n}\n\nexport const DraggableMixin = <T extends Constructor<LitElement>>(superClass: T) => {\n  // @ts-ignore\n  class DraggableMixinEl extends superClass {\n    dragable: any;\n    _position: any;\n    static get styles() {\n      return [\n        // @ts-ignore\n        super.styles,\n        css`\n          /* NOTE this requires explicit properties to work as expected\n\t\t\t\t\t * possibly a combination of left-min/max width/height, -top/-left initial values\n\t\t\t\t\t * also note z variables below\n\t\t\t\t\t */\n          :host,\n          [drag-able] {\n            margin: 0;\n            --drag-left-min: 0vw;\n            --drag-left: auto;\n            --drag-left-max: calc(100vw - 4rem);\n            --drag-top-min: 0vh;\n            --drag-top: auto;\n            --drag-top-max: calc(100vh - 4rem);\n            /* NOTE can adjust per content */\n            --drag-top-max: calc(100vh - var(--drag-height));\n            --drag-left-max: calc(100vw - var(--drag-width));\n          }\n          :host([drag-able]),\n          ::slotted([drag-able]),\n          :is([drag-able]) {\n            position: fixed;\n            cursor: move;\n            top: clamp(\n              var(--drag-top-min, 0vh),\n              var(--drag-top, 0),\n              var(--drag-top-max, calc(100vh - var(--drag-height, 50px)))\n            );\n            left: clamp(\n              var(--drag-left-min, 0vw),\n              var(--drag-left, 0),\n              var(--drag-left-max, calc(100vw - var(--drag-width, 20px)))\n            );\n            z-index: var(--drag-able-z, auto);\n          }\n          :host(:is([drag-able][active])),\n          ::slotted(:is([drag-able][active])),\n          :is([drag-able][active]) {\n            /* below Bulma modal (40) above omni-tooltip (38) */\n            z-index: var(--drag-z, 39);\n          }\n        `\n      ];\n    }\n\n    static get properties() {\n      return { dragable: { type: Boolean, attribute: 'drag-able' } };\n    }\n\n    constructor() {\n      super();\n      this.addEventListener('pointerdown', this._dragstart);\n      this._dragend = this._dragend.bind(this);\n      this._dragmove = this._dragmove.bind(this);\n      console.warn('The DraggableMixin is deprecated and will be removed in the upcoming Omni-UI 8.0 release. Please use the DraggableController instead. https://omni-ui.annalect.com/draggable-controller');\n    }\n\n    /* Supports host or element in shadowRoot */\n    _draggable(el = this) {\n      if (!el.dragable) {\n        el.dragable = true;\n        if (el === this) {\n          return;\n        }\n        el.setAttribute('drag-able', '');\n      }\n\n      el._dragposition = this._dragposition;\n      el._dragend = this.constructor.prototype._dragend.bind(el);\n      el._dragmove = this.constructor.prototype._dragmove.bind(el);\n      el.addEventListener('pointerdown', this._dragstart);\n    }\n\n    _undraggable(el = this) {\n      el.dragable = false;\n      el._dragend();\n    }\n\n    disconnectedCallback() {\n      super.disconnectedCallback();\n      this._dragend();\n    }\n\n    _dragend() {\n      this.removeAttribute('active');\n      this.removeEventListener('drag', this._dragposition);\n      const { ownerDocument } = this;\n      ownerDocument.removeEventListener('pointermove', this._dragmove);\n      ownerDocument.removeEventListener('pointerup', this._dragend);\n      ownerDocument.removeEventListener('pointerout', this._dragend);\n      ownerDocument.removeEventListener('mouseleave', this._dragend);\n      ownerDocument.removeEventListener('mouseout', this._dragend);\n\n      this.dispatchEvent(new CustomEvent('dragend', { bubbles: true, composed: true, detail: this._position }));\n    }\n\n    _dragstart(event) {\n      const { pageX, pageY, ctrlKey, button } = event;\n      if (!this.dragable || ctrlKey || button) return;\n      this.setAttribute('active', '');\n      this.addEventListener('drag', this._dragposition);\n      const { left, top, width, height } = this.getBoundingClientRect();\n      // for container-relative positioning\n      const { innerWidth, innerHeight } = self;\n      const offsetX = pageX - left;\n      const offsetY = pageY - top;\n      this._position = {\n        left,\n        top,\n        offsetX,\n        offsetY,\n        width,\n        height,\n        availableWidth: innerWidth,\n        availableHeight: innerHeight\n      };\n      this.dispatchEvent(new CustomEvent('dragstart', { bubbles: true, composed: true, detail: this._position }));\n      const { ownerDocument } = this;\n      ownerDocument.addEventListener('mouseleave', this._dragend);\n      ownerDocument.addEventListener('mouseout', this._dragend);\n      ownerDocument.addEventListener('pointerout', this._dragend);\n      ownerDocument.addEventListener('pointerup', this._dragend);\n      ownerDocument.addEventListener('pointermove', this._dragmove);\n      this._dragmove(event);\n    }\n\n    _dragposition() {\n      // @ts-ignore\n      cancelAnimationFrame(this._dragrender);\n      // @ts-ignore\n      this._dragrender = requestAnimationFrame(() => {\n        const { style, _position } = this;\n        const { left, top, width, height } = _position;\n        /*\n\t\t\t\t// positioning relative to the given area\n\t\t\t\tstyle.setProperty('--drag-left', `${(left/availableWidth*100).toFixed(2)}%`);\n\t\t\t\tstyle.setProperty('--drag-top', `${(top/availableHeight*100).toFixed(2)}%`);\n\t\t\t\t*/\n        // positioning biased toward a specific position\n        style.setProperty('--drag-left', `${Math.round(left)}px`);\n        style.setProperty('--drag-top', `${Math.round(top)}px`);\n        style.setProperty('--drag-width', `${Math.round(width)}px`);\n        style.setProperty('--drag-height', `${Math.round(height)}px`);\n      });\n    }\n\n    _dragrender(_dragrender: any) {\n      throw new Error('Method not implemented.');\n    }\n\n    _dragmove(event) {\n      event.preventDefault();\n      const { pageX, pageY } = event;\n      const { _position } = this;\n      const { offsetX, offsetY } = _position;\n      const left = pageX - offsetX;\n      const top = pageY - offsetY;\n      _position.left = left;\n      _position.top = top;\n\n      this.dispatchEvent(new CustomEvent('drag', { bubbles: true, composed: true, detail: _position }));\n    }\n  }\n  return DraggableMixinEl as Constructor<DraggableMixinInterface> & T;\n};\n"],
  "mappings": "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",
  "names": []
}
