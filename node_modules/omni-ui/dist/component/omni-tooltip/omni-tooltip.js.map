{
  "version": 3,
  "sources": ["../../../lib/component/omni-tooltip/omni-tooltip.ts"],
  "sourcesContent": ["import { property } from 'lit/decorators.js';\nimport { OmniElement } from '../../omni-element.js';\nimport { OmniOverlay } from '../omni-overlay/omni-overlay.js';\nimport './omni-tooltip-overlay.js';\n\nimport {css} from 'lit';\nconst styles = css`:host{display:inline-block;contain:strict style}slot[name=invoker]::slotted([disabled]){pointer-events:none}[tooltip],slot[name=content],slot[name=content]::slotted(*){display:none}`\n\n\n/**\n * To include within your project `import { OmniTooltipElement } from 'omni-ui';`\n *\n * @tagname omni-tooltip\n * @slot content - content to display in the tooltip\n * @slot invoker - parent element that triggers the tooltip\n * @cssprop [--tooltip-background-color=linear-gradient(to bottom, #2b3952, #142033 100%)]\n * @cssprop [--tooltip-text-color=white]\n */\nexport class OmniTooltipElement extends OmniElement {\n  static get styles() {\n    return [...super.styles, styles];\n  }\n\n  static get count() {\n    const count = this.#count ?? 0;\n    this.#count = count + 1;\n    return this.#count;\n  }\n\n  static #count: number;\n  /** @internal */\n  __id: string = `_tooltip${OmniTooltipElement.count}_`;\n  #observer: MutationObserver;\n  #mutationConfig: MutationObserverInit = { attributes: true, childList: true, subtree: true };\n  @property({ type: Boolean, reflect: true }) open: boolean;\n  @property({ type: Boolean, reflect: true }) disabled: boolean;\n  @property({ type: Boolean, reflect: true, attribute: 'show-on-disabled' }) showOnDisabled: boolean = false;\n  @property({ type: String }) relateby: 'describe' | 'label' = 'describe';\n  @property({ type: String, reflect: true }) place: 'top' | 'bottom' | 'left' | 'right' = 'top';\n  /** @internal */\n  tooltip: HTMLElement & { origin: OmniTooltipElement; noflip: boolean };\n  /** @internal */\n  content: HTMLSlotElement;\n  /** @internal */\n  event: Event;\n  /** @internal */\n  invoker: HTMLSlotElement;\n\n  constructor() {\n    super();\n    /** @internal */\n    this.attachShadow({ mode: 'open' }).innerHTML = `\n\t\t\t<slot name=\"invoker\"></slot>\n\t\t\t<slot name=\"content\"></slot>\n\t\t\t<omni-tooltip-overlay slot=\"indicator\" tooltip></omni-tooltip-overlay>\n\t\t`;\n    const { shadowRoot } = this;\n    // expando transient node\n    /** @internal */\n    this.tooltip = shadowRoot.querySelector('[tooltip]');\n    /** @internal */\n    this.tooltip.origin = this;\n    /** @internal */\n    this.content = shadowRoot.querySelector('slot[name=\"content\"]');\n    /** @internal */\n    this.invoker = shadowRoot.querySelector('slot[name=\"invoker\"]');\n\n    shadowRoot\n      .querySelectorAll('slot')\n      .forEach(node => node.addEventListener('slotchange', this._slotchange.bind(this)));\n    this._show = this._show.bind(this);\n    this._hide = this._hide.bind(this);\n\n    this.tooltip.remove();\n    this.tooltip.addEventListener('overlay-remove', this._hide);\n\n    this.addEventListener('mouseenter', this._show);\n    this.addEventListener('focusin', this._show);\n    this.addEventListener('mouseleave', this._hide);\n    this.addEventListener('click', this._hide);\n    this.addEventListener('focusout', this._hide);\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n    // initialize the overlay\n    OmniOverlay.overlay;\n\n    const invoker = this.invoker.assignedElements()[0];\n    if (invoker) {\n      this.#observer = new MutationObserver(this.#mutation);\n      this.#observer.observe(invoker, this.#mutationConfig);\n    }\n\n    if (this.open) {\n      requestAnimationFrame(() => {\n        this._show();\n      });\n    }\n  }\n\n  disconnectedCallback() {\n    super.disconnectedCallback();\n    this._hide();\n    if (this.#observer) {\n      this.#observer?.disconnect();\n    }\n  }\n\n  #mutation = (mutationList: MutationRecord[]) => {\n    mutationList.forEach((m: MutationRecord) => {\n      if (m.type === 'attributes') {\n        const target = m.target as HTMLElement & { disabled: boolean };\n        if (m.attributeName === 'disabled' && target.slot === 'invoker') {\n          this.disabled = target.disabled;\n        }\n      }\n    });\n  };\n\n  get noflip() {\n    return this.hasAttribute('noflip');\n  }\n\n  set noflip(flag) {\n    flag ? this.setAttribute('noflip', '') : this.removeAttribute('noflip');\n  }\n\n  _show() {\n    if (this.disabled && !this.showOnDisabled) return;\n    this.open = true;\n  }\n\n  _hide() {\n    this.open = false;\n    // overlay events are handled via requestAnimationFrame\n    // add removal to that task loop\n    this.event?.stopImmediatePropagation();\n    requestAnimationFrame(() => {\n      this.tooltip.remove();\n      Array.from(this.tooltip.children).forEach(node => this.appendChild(node));\n    });\n  }\n\n  _attr(node, attr = 'attr', value = '') {\n    if (!node.hasAttribute(attr)) {\n      node.setAttribute(attr, value);\n    }\n  }\n\n  fakePromise() {\n    return new Promise(resolve => {\n      setTimeout(() => {\n        resolve(true);\n      }, 0);\n    });\n  }\n\n  isContentEmpty() {\n    if (!this.content.assignedElements().length) {\n      this._hide();\n      return true;\n    } else {\n      let checkInnerContentText = false;\n      this.content.assignedElements().forEach(node => {\n        const _node = node as Element & { innerText: { trim: () => string } };\n        if (_node.innerText.trim()) checkInnerContentText = true;\n      });\n      if (!checkInnerContentText) {\n        this._hide();\n        return true;\n      }\n      return false;\n    }\n  }\n\n  async updated(changedProperties) {\n    const styles = getComputedStyle(this);\n    if (changedProperties.has('disabled') || changedProperties.has('showOnDisabled')) {\n      this._hide();\n    } else if (changedProperties.has('open')) {\n      const eventListenerOptions = { capture: true, once: true } as EventListenerOptions;\n      const { open } = this;\n      if (open) {\n        const { tooltip, className } = this;\n        tooltip.className = className;\n        tooltip.noflip = this.noflip;\n\n        //check if we have any content for tooltip.\n        if (this.isContentEmpty()) return;\n\n        //using this allows slotted content before rending.\n        await this.fakePromise();\n        this.content.assignedElements().forEach(node => tooltip.appendChild(node));\n        const { width, height, x, y } = this.getBoundingClientRect();\n        const { style } = tooltip;\n        style.setProperty('--trigger-width', `${Math.round(width)}px`);\n        style.setProperty('--trigger-height', `${Math.round(height)}px`);\n        style.setProperty('--trigger-top', `${Math.round(y)}px`);\n        style.setProperty('--trigger-left', `${Math.round(x)}px`);\n        style.setProperty('--tooltip-background-color', styles.getPropertyValue('--tooltip-background-color'));\n        style.setProperty('--tooltip-text-color', styles.getPropertyValue('--tooltip-text-color'));\n        this.event = new CustomEvent('overlay', {\n          detail: this.tooltip,\n          bubbles: true,\n          composed: true\n        });\n        this.dispatchEvent(this.event);\n        self.addEventListener('mousewheel', this._hide, eventListenerOptions);\n        self.addEventListener('keydown', this._hide, eventListenerOptions);\n        this.tooltip.setAttribute('place', this.place);\n      } else {\n        self.removeEventListener('mousewheel', this._hide, eventListenerOptions);\n        self.removeEventListener('keydown', this._hide, eventListenerOptions);\n        this._hide();\n      }\n    } else if (changedProperties.has('place')) {\n      // mirror to [tooltip] for overlay\n      this.tooltip.setAttribute('place', this.place);\n    }\n  }\n\n  _slotchange({ target }) {\n    const nodes = target.assignedElements();\n    const [firstElement] = nodes;\n    if (!firstElement) return;\n    switch (target.name) {\n      case 'invoker':\n        if (firstElement.disabled) {\n          this.disabled = true;\n        }\n        this._attr(firstElement, this.relateby.includes('label') ? 'aria-labelledby' : 'aria-describedby', this.__id);\n        break;\n      case 'content':\n        this._attr(firstElement, 'role', 'tooltip');\n        this._attr(firstElement, 'id', this.__id);\n        this.requestUpdate();\n        break;\n    }\n  }\n}\n\nOmniElement.register('omni-tooltip', OmniTooltipElement);\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'omni-tooltip': OmniTooltipElement;\n  }\n}\n"],
  "mappings": "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",
  "names": ["styles"]
}
