{
  "version": 3,
  "sources": ["../../../lib/component/omni-theme/omni-theme.ts"],
  "sourcesContent": ["import { OmniElement } from '../../omni-element.js';\nimport { OmniStyleElement } from '../omni-style/omni-style.js';\n\n/**\n * To include within your project `import { OmniThemeElement } from 'omni-ui';`\n *\n * Change the default `omni-style` theme <br>\n * by adjusting stylesheet css properties intended for theming\n *\n * ```js\n * // in a component class: dispatch a custom event with detail of key-value pairs of css props to update (can be multiple at once)\n * this.dispatchNewEvent('omni-theme', {detail: {'--rgb-primary': '0, 161, 210', '--rgb-secondary': '3, 187, 227'}})\n *\n * // at the top level in <body>, add an empty omni-theme\n * // this will catch the event and update the css-props\n * html`\n *  <omni-theme></omni-theme>\n * `\n * ```\n *\n * @tagname omni-theme\n */\nexport class OmniThemeElement extends OmniStyleElement {\n  static get defaultSelector() {\n    return '.omni';\n  }\n\n  constructor() {\n    super();\n    this._themeListener = this._themeListener.bind(this);\n  }\n\n  get selector() {\n    return (this.getAttribute('selector') || '').trim();\n  }\n\n  // @ts-ignore\n  set selector(cssSelector = '') {\n    // @ts-ignore\n    return cssSelector.trim() ? this.setAttribute('selector', cssSelector) : this.removeAttribute('selector');\n  }\n\n  /* \n      @return {return} the theme-specific stylesheet that's inherited everywhere (document and shadowRoots) via omni-style\n   */\n  get styleSheet() {\n    const { adoptedStyleSheets = [] } = this.ownerDocument;\n    // assumptions about how this works TODO\n    return adoptedStyleSheets[0] ?? null;\n  }\n\n  _formatRule([property, value]) {\n    const name = this[property] ?? property;\n    return `${name}:${value} !important;`;\n  }\n\n  _filterProperties([property]) {\n    return property.startsWith('--');\n  }\n\n  _themeListener(event) {\n    const { detail } = event;\n    requestAnimationFrame(() => {\n      const { selector, styleSheet } = this;\n      const selectorMark = this.nodeName.toLowerCase() + (selector ? `[selector=\"${selector}\"]` : '');\n      const { rules } = styleSheet;\n      for (let rule, i = rules.length; i--; i >= 0) {\n        rule = rules[i];\n        if (rule.selectorText?.includes(selectorMark)) {\n          styleSheet.deleteRule(i);\n          break;\n        }\n      }\n\n      /** optional translate dictionary\n             * event.detail\n             {\n                translate: {'--other-system-name': '--omniui-actual-name'},\n                '--other-system-name':'#example-value'\n                '--name':'#value'\n                ...\n             }\n             */\n      const { translate = {} } = detail;\n\n      const cssRule = `${selectorMark}, ${selector || OmniThemeElement.defaultSelector}{${Object.entries(detail)\n        // @ts-ignore\n        .filter(this._filterProperties)\n        .map(this._formatRule, translate)\n        .join(' ')}}`;\n      styleSheet.insertRule(cssRule, styleSheet.rules.length);\n    });\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n    self.addEventListener('omni-theme', this._themeListener);\n  }\n\n  disconnectedCallback() {\n    super.disconnectedCallback();\n    self.removeEventListener('omni-theme', this._themeListener);\n  }\n}\n\nOmniElement.register('omni-theme', OmniThemeElement);\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    'omni-theme': OmniThemeElement;\n  }\n}\n"],
  "mappings": "AAAA,SAAS,mBAAmB;AAC5B,SAAS,wBAAwB;AAqB1B,MAAM,yBAAyB,iBAAiB;AAAA,EACrD,WAAW,kBAAkB;AAC3B,WAAO;AAAA,EACT;AAAA,EAEA,cAAc;AACZ,UAAM;AACN,SAAK,iBAAiB,KAAK,eAAe,KAAK,IAAI;AAAA,EACrD;AAAA,EAEA,IAAI,WAAW;AACb,YAAQ,KAAK,aAAa,UAAU,KAAK,IAAI,KAAK;AAAA,EACpD;AAAA;AAAA,EAGA,IAAI,SAAS,cAAc,IAAI;AAE7B,WAAO,YAAY,KAAK,IAAI,KAAK,aAAa,YAAY,WAAW,IAAI,KAAK,gBAAgB,UAAU;AAAA,EAC1G;AAAA;AAAA;AAAA;AAAA,EAKA,IAAI,aAAa;AACf,UAAM,EAAE,qBAAqB,CAAC,EAAE,IAAI,KAAK;AAEzC,WAAO,mBAAmB,CAAC,KAAK;AAAA,EAClC;AAAA,EAEA,YAAY,CAAC,UAAU,KAAK,GAAG;AAC7B,UAAM,OAAO,KAAK,QAAQ,KAAK;AAC/B,WAAO,GAAG,IAAI,IAAI,KAAK;AAAA,EACzB;AAAA,EAEA,kBAAkB,CAAC,QAAQ,GAAG;AAC5B,WAAO,SAAS,WAAW,IAAI;AAAA,EACjC;AAAA,EAEA,eAAe,OAAO;AACpB,UAAM,EAAE,OAAO,IAAI;AACnB,0BAAsB,MAAM;AAC1B,YAAM,EAAE,UAAU,WAAW,IAAI;AACjC,YAAM,eAAe,KAAK,SAAS,YAAY,KAAK,WAAW,cAAc,QAAQ,OAAO;AAC5F,YAAM,EAAE,MAAM,IAAI;AAClB,eAAS,MAAM,IAAI,MAAM,QAAQ,KAAK,KAAK,GAAG;AAC5C,eAAO,MAAM,CAAC;AACd,YAAI,KAAK,cAAc,SAAS,YAAY,GAAG;AAC7C,qBAAW,WAAW,CAAC;AACvB;AAAA,QACF;AAAA,MACF;AAWA,YAAM,EAAE,YAAY,CAAC,EAAE,IAAI;AAE3B,YAAM,UAAU,GAAG,YAAY,KAAK,YAAY,iBAAiB,eAAe,IAAI,OAAO,QAAQ,MAAM,EAEtG,OAAO,KAAK,iBAAiB,EAC7B,IAAI,KAAK,aAAa,SAAS,EAC/B,KAAK,GAAG,CAAC;AACZ,iBAAW,WAAW,SAAS,WAAW,MAAM,MAAM;AAAA,IACxD,CAAC;AAAA,EACH;AAAA,EAEA,oBAAoB;AAClB,UAAM,kBAAkB;AACxB,SAAK,iBAAiB,cAAc,KAAK,cAAc;AAAA,EACzD;AAAA,EAEA,uBAAuB;AACrB,UAAM,qBAAqB;AAC3B,SAAK,oBAAoB,cAAc,KAAK,cAAc;AAAA,EAC5D;AACF;AAEA,YAAY,SAAS,cAAc,gBAAgB;",
  "names": []
}
